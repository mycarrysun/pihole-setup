# Hardware watchdog configuration for Raspberry Pi
# The Pi's hardware watchdog has a maximum timeout of 15 seconds
# We use 14 to stay safely under the limit

# Watchdog device
watchdog-device = /dev/watchdog

# Timeout (must be < 15 seconds on Raspberry Pi)
watchdog-timeout = 14

# Interval to reset the watchdog timer
interval = 10

# Realtime scheduling for watchdog daemon
realtime = yes
priority = 1

# =============================================================================
# SYSTEM HEALTH MONITORING
# =============================================================================

# Load thresholds - reboot if system is overloaded
# On a 4-core Pi, load of 24 means severely overloaded
max-load-1 = 24
max-load-5 = 18
max-load-15 = 12

# Memory monitoring - reboot if free memory drops below threshold
# Value is in pages (typically 4KB each). 1 = minimum check enabled
min-memory = 1

# =============================================================================
# DISK MONITORING
# =============================================================================

# Monitor free space on root filesystem
# Reboot if free space drops below 5MB (prevents log/db corruption)
allocatable-memory = 5120

# =============================================================================
# NETWORK MONITORING
# =============================================================================

# Network connectivity check - reboot if router unreachable
# ROUTER_IP will be replaced by setup.sh
ping = ROUTER_IP
ping-count = 3

# =============================================================================
# SERVICE MONITORING
# =============================================================================

# Monitor Docker daemon - reboot if Docker dies
pidfile = /var/run/docker.pid

# Custom test script for container health
test-binary = /usr/local/bin/watchdog-test.sh
test-timeout = 30

# =============================================================================
# LOGGING
# =============================================================================

# Verbose logging (set to no for production)
verbose = no
